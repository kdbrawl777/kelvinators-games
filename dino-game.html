<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shinigami Strikers</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>‚öîÔ∏è Shinigami Strikers ‚öîÔ∏è</h1>
<p>W/S (Top) ‚Ä¢ ‚Üë/‚Üì (Bottom)</p>

<canvas id="game" width="900" height="300"></canvas>
<p id="ui"></p>
<button onclick="restart()">Restart</button>

<script>
/* ======================
   CANVAS
   ====================== */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

/* ======================
   GAME STATE
   ====================== */
let animationId, spawnTimer;
let speed, gravity = 1;
let score1, score2;
let enemies = [];
let chakra = 0;

/* ======================
   PLAYER
   ====================== */
function makePlayer(yBase) {
  return {
    x: 60,
    y: yBase,
    baseY: yBase,
    w: 26,
    h: 36,
    vy: 0,
    duck: false,
    alive: true
  };
}

let p1, p2;

/* ======================
   DRAW PLAYER
   ====================== */
function drawPlayer(p, color) {
  ctx.fillStyle = color;
  ctx.fillRect(p.x, p.y, p.w, p.h);

  // headband
  ctx.fillStyle = "#222";
  ctx.fillRect(p.x, p.y + 6, p.w, 5);
}

/* ======================
   NARUTO-STYLE BACKGROUND
   ====================== */
function drawBackground() {
  // sunset sky
  const g = ctx.createLinearGradient(0,0,0,canvas.height);
  g.addColorStop(0, "#ffb347");
  g.addColorStop(1, "#ff5f1f");
  ctx.fillStyle = g;
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // chakra streaks
  chakra -= speed * 0.6;
  ctx.fillStyle = "rgba(0,255,255,0.15)";
  for (let i = 0; i < 10; i++) {
    ctx.fillRect((i*180 + chakra) % canvas.width, 0, 60, canvas.height);
  }

  // swirl symbols
  ctx.strokeStyle = "rgba(0,0,0,0.2)";
  for (let x = 120; x < canvas.width; x += 260) {
    for (let y = 70; y < canvas.height; y += 140) {
      ctx.beginPath();
      ctx.arc(x, y, 18, 0, Math.PI * 1.5);
      ctx.stroke();
    }
  }

  // chakra divider
  ctx.strokeStyle = "#00ffff";
  ctx.beginPath();
  ctx.moveTo(0,150);
  ctx.lineTo(canvas.width,150);
  ctx.stroke();
}

/* ======================
   ENEMIES (SHURIKEN)
   ====================== */
function spawnEnemy() {
  const lane = Math.random() < 0.5 ? 0 : 1;

  // spacing protection
  if (enemies.some(e => e.lane === lane && e.x > canvas.width - 300)) return;

  enemies.push({
    x: canvas.width,
    lane,
    flying: Math.random() < 0.5,
    w: 24,
    h: 24
  });
}

/* ======================
   INPUT
   ====================== */
document.addEventListener("keydown", e => {
  if (e.key === "w") jump(p1);
  if (e.key === "s") duck(p1, true);
  if (e.key === "ArrowUp") jump(p2);
  if (e.key === "ArrowDown") duck(p2, true);
});

document.addEventListener("keyup", e => {
  if (e.key === "s") duck(p1, false);
  if (e.key === "ArrowDown") duck(p2, false);
});

function jump(p) {
  if (p.alive && p.y === p.baseY) p.vy = -15;
}

function duck(p, on) {
  p.duck = on;
  p.h = on ? 20 : 36;
  p.y = on ? p.baseY + 16 : p.baseY;
}

/* ======================
   GAME LOOP
   ====================== */
function update() {
  ctx.clearRect(0,0,canvas.width,canvas.height);
  drawBackground();

  [p1, p2].forEach(p => {
    if (!p.alive) return;
    p.vy += gravity;
    p.y += p.vy;
    if (p.y > p.baseY) {
      p.y = p.baseY;
      p.vy = 0;
    }
  });

  drawPlayer(p1, "#003cff");
  drawPlayer(p2, "#00aa44");

  enemies.forEach((e,i) => {
    e.x -= speed;
    const laneY = e.lane === 0 ? 114 : 264;
    const y = e.flying ? laneY - 40 : laneY;

    // shuriken
    ctx.fillStyle = "#111";
    ctx.beginPath();
    ctx.arc(e.x, y+12, 10, 0, Math.PI*2);
    ctx.fill();

    [[p1,0],[p2,1]].forEach(([p,l]) => {
      if (!p.alive || e.lane !== l) return;
      if (
        p.x < e.x + e.w &&
        p.x + p.w > e.x &&
        p.y < y + e.h &&
        p.y + p.h > y
      ) p.alive = false;
    });

    if (e.x < -40) enemies.splice(i,1);
  });

  if (p1.alive) score1++;
  if (p2.alive) score2++;

  speed += 0.0025;

  document.getElementById("ui").textContent =
    `P1: ${score1} ${p1.alive ? "" : "üíÄ"} | P2: ${score2} ${p2.alive ? "" : "üíÄ"}`;

  animationId = requestAnimationFrame(update);
}

/* ======================
   START
   ====================== */
function restart() {
  cancelAnimationFrame(animationId);
  clearInterval(spawnTimer);

  speed = 5;
  score1 = score2 = 0;
  enemies = [];

  p1 = makePlayer(114);
  p2 = makePlayer(264);

  spawnTimer = setInterval(spawnEnemy, 1100);
  update();
}

restart();
</script>

</body>
</html>
