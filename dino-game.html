<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shinigami Strikers</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>Shinigami Strikers</h1>
<p>W/S (Top) â€¢ â†‘/â†“ (Bottom)</p>

<canvas id="game" width="900" height="300"></canvas>
<p id="ui"></p>
<button onclick="restart()">Restart</button>

<script>
/* ===== CANVAS ===== */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

/* ===== GAME STATE ===== */
let speed, gravity = 1;
let enemies, score1, score2;
let animationId;

/* ===== PLAYER ===== */
function makePlayer(y) {
  return {
    x: 60,
    y: y,
    baseY: y,
    w: 26,
    h: 36,
    vy: 0,
    alive: true
  };
}

let p1, p2;

/* ===== INPUT ===== */
document.addEventListener("keydown", e => {
  if (e.key === "w" && p1.y === p1.baseY) p1.vy = -15;
  if (e.key === "ArrowUp" && p2.y === p2.baseY) p2.vy = -15;
});

/* ===== ENEMIES ===== */
function spawnEnemy() {
  enemies.push({
    x: canvas.width,
    lane: Math.random() < 0.5 ? 0 : 1,
    flying: Math.random() < 0.4,
    w: 20,
    h: 30
  });
}

/* ===== LOOP ===== */
function update() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  /* background */
  ctx.fillStyle = "#ff914d";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  ctx.strokeStyle = "#00ffff";
  ctx.beginPath();
  ctx.moveTo(0,150);
  ctx.lineTo(canvas.width,150);
  ctx.stroke();

  /* players */
  [p1,p2].forEach(p => {
    if (!p.alive) return;

    p.vy += gravity;
    p.y += p.vy;

    if (p.y > p.baseY) {
      p.y = p.baseY;
      p.vy = 0;
    }

    ctx.fillStyle = "#111";
    ctx.fillRect(p.x, p.y, p.w, p.h);
  });

  /* enemies */
  enemies.forEach((e,i) => {
    e.x -= speed;
    const laneY = e.lane === 0 ? 114 : 264;
    const y = e.flying ? laneY - 40 : laneY;

    ctx.fillStyle = e.flying ? "yellow" : "red";
    ctx.fillRect(e.x, y, e.w, e.h);

    [[p1,0],[p2,1]].forEach(([p,l])=>{
      if (e.lane !== l) return;
      if (
        p.x < e.x + e.w &&
        p.x + p.w > e.x &&
        p.y < y + e.h &&
        p.y + p.h > y
      ) p.alive = false;
    });

    if (e.x < -40) enemies.splice(i,1);
  });

  if (p1.alive) score1++;
  if (p2.alive) score2++;

  document.getElementById("ui").textContent =
    `P1: ${score1} ${p1.alive?"":"ðŸ’€"} | P2: ${score2} ${p2.alive?"":"ðŸ’€"}`;

  animationId = requestAnimationFrame(update);
}

/* ===== RESTART ===== */
function restart() {
  cancelAnimationFrame(animationId);
  speed = 5;
  score1 = score2 = 0;
  enemies = [];
  p1 = makePlayer(114);
  p2 = makePlayer(264);
  update();
}

/* ===== START ===== */
setInterval(spawnEnemy, 1200);
restart();
</script>

</body>
</html>
