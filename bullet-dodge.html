<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Big K Bullet Dodger V6</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    margin: 0;
    background: black;
    font-family: Arial, sans-serif;
    text-align: center;
    color: #00ff00;
  }
  canvas {
    display: block;
    margin: 20px auto;
    border: 3px solid #00ff00;
    background: #111;
  }
</style>
</head>
<body>

<h1>Big K Bullet Dodger</h1>
<p>Arrow Keys • Dodge Bullets • Eat Pancakes</p>
<canvas id="game" width="600" height="400"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

/* ===== INPUT ===== */
let keys = {};
document.addEventListener("keydown", e=>keys[e.key]=true);
document.addEventListener("keyup", e=>keys[e.key]=false);

/* ===== PLAYER ===== */
let player = {
  x:300,
  y:300,
  w:50,
  h:100,
  speed:5,
  hp:3,
  alive:true,
  wobble:0
};

/* ===== GAME STATE ===== */
let bullets = [];
let powerups = [];
let frame = 0;
let difficulty = 1;
let slowTime = 0;
let speechShown = false;
let speechAlpha = 0;
let speechY = -20;

/* ===== BULLETS ===== */
function spawnBullet(){
  const side=Math.floor(Math.random()*4);
  let x,y,dx,dy;
  let speed = 5 + difficulty*0.8;
  if(slowTime>0) speed*=0.4;
  if(side===0){x=Math.random()*600;y=-20;dx=0;dy=speed;}
  if(side===1){x=Math.random()*600;y=420;dx=0;dy=-speed;}
  if(side===2){x=-20;y=Math.random()*400;dx=speed;dy=0;}
  if(side===3){x=620;y=Math.random()*400;dx=-speed;dy=0;}
  bullets.push({x,y,dx,dy,w:20,h:10});
}

/* ===== POWERUPS ===== */
function spawnPowerup(){
  const type = Math.random()<0.5?"pancake":"syrup";
  powerups.push({x:Math.random()*540+30,y:Math.random()*320+30,r:12,type,wobble:0});
}

/* ===== DRAW PLAYER (FUNNY, WEIRD STICK FIGURE) ===== */
function drawPlayer(){
  // wobble body
  player.wobble = Math.sin(frame/5)*5;

  // torso
  ctx.fillStyle="#000";
  ctx.fillRect(player.x,player.y+player.wobble,player.w,player.h);

  // head (weird oversized)
  ctx.beginPath();
  ctx.arc(player.x+player.w/2,player.y-20,player.w/2,0,Math.PI*2);
  ctx.fillStyle="#000";
  ctx.fill();

  // white crusty braids
  ctx.fillStyle="#eee";
  for(let i=0;i<6;i++){
    ctx.fillRect(player.x-6+i*12,player.y-35+i*2,8,12);
  }

  // arms (funny, weird)
  ctx.fillStyle="#000";
  ctx.fillRect(player.x-10,player.y+20,10,player.h/2);
  ctx.fillRect(player.x+player.w,player.y+20,10,player.h/2);

  // legs
  ctx.fillRect(player.x+5,player.y+player.h,10,20);
  ctx.fillRect(player.x+player.w-15,player.y+player.h,10,20);
}

/* ===== DRAW BULLET ===== */
function drawBullet(b){
  ctx.shadowColor="red"; ctx.shadowBlur=12;
  ctx.fillStyle="#aaa"; ctx.fillRect(b.x,b.y,b.w,b.h);
  ctx.fillStyle="#666"; ctx.fillRect(b.x+b.w-5,b.y,5,b.h);
  ctx.shadowBlur=0;
}

/* ===== DRAW POWERUPS ===== */
function drawPowerup(p){
  p.wobble=Math.sin(frame/10+p.x)*2;
  if(p.type==="pancake"){
    ctx.fillStyle="#ffcc66";
    ctx.fillRect(p.x-8,p.y-4+p.wobble,16,8);
    ctx.fillStyle="#996633";
    ctx.fillRect(p.x-6,p.y-2+p.wobble,12,2); // syrup line
  } else {
    ctx.fillStyle="#663300";
    ctx.fillRect(p.x-4,p.y-10+p.wobble,8,16);
    ctx.fillStyle="#ffcc00"; ctx.fillRect(p.x-3,p.y-12+p.wobble,6,4); // cap
  }
}

/* ===== LOOP ===== */
function update(){
  ctx.clearRect(0,0,600,400);
  if(!player.alive){
    ctx.fillStyle="red"; ctx.font="40px Arial";
    ctx.fillText("GAME OVER",150,200);
    return;
  }

  frame++;
  difficulty = Math.min(10,1 + frame/400);
  if(slowTime>0) slowTime--;

  // move
  if(keys["ArrowUp"]) player.y-=player.speed;
  if(keys["ArrowDown"]) player.y+=player.speed;
  if(keys["ArrowLeft"]) player.x-=player.speed;
  if(keys["ArrowRight"]) player.x+=player.speed;
  player.x = Math.max(0,Math.min(550,player.x));
  player.y = Math.max(0,Math.min(320,player.y));

  drawPlayer();

  // bullets
  bullets.forEach((b,i)=>{
    b.x+=b.dx;b.y+=b.dy;
    drawBullet(b);
    if(player.x<b.x+b.w && player.x+player.w>b.x &&
       player.y<b.y+b.h && player.y+player.h>b.y){
      bullets.splice(i,1);
      player.hp--;
      if(player.hp<=0){player.hp=0;player.alive=false;}
    }
  });
  bullets = bullets.filter(b=>b.x>-30 && b.x<630 && b.y>-30 && b.y<430);

  // powerups
  powerups.forEach((p,i)=>{
    drawPowerup(p);
    if(player.x<p.x+p.r && player.x+player.w>p.x-p.r &&
       player.y<p.y+p.r && player.y+player.h>p.y-p.r){
      powerups.splice(i,1);
      if(difficulty>=10 && !speechShown){
        speechShown=true;
        speechAlpha=1;
      }
      if(p.type==="syrup") slowTime=240;
      else player.hp=Math.min(3,player.hp+1);
    }
  });

  // draw floating speech bubble if triggered
  if(speechAlpha>0){
    ctx.globalAlpha = speechAlpha;
    ctx.fillStyle="white";
    ctx.font="16px Arial";
    ctx.fillText("you still thinking about them pancakes",player.x-50,player.y-50+Math.sin(frame/10)*5);
    ctx.globalAlpha = 1;
    speechAlpha -= 0.002;
  }

  // HUD
  ctx.fillStyle="#00ff00";
  ctx.font="16px Arial";
  ctx.fillText("HP: "+player.hp,10,20);
  ctx.fillText("DIFFICULTY: "+difficulty.toFixed(1),10,40);

  // SPAWNS
  if(frame%20===0) spawnBullet();
  if(frame%300===0) spawnPowerup();

  requestAnimationFrame(update);
}

update();
</script>
</body>
</html>
